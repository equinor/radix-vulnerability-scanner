package db

import (
	"context"
	"time"
)

// Repository defines methods for reading and storing data about vulnerability scans
type Repository interface {
	// GetLastImageScan returns the last vulnerability scan for an image
	GetLastImageScan(ctx context.Context, image string) (*ImageScanDto, error)
	// RegisterImageScan stores information about a vulnerability scan for an image
	RegisterImageScan(ctx context.Context, image string, baseImage *string, scanTime time.Time, success bool, vulnerabilities []VulnerabilityBulkDto, identifiers []VulnerabilityIdentifierBulkDto, references []VulnerabilityReferenceBulkDto) error
}
